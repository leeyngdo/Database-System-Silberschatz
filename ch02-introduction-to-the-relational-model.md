# Table of Contents
<details><summary>click to expand</summary>

[2.1](#21) <br>
[2.2](#22) <br>
[2.3](#23) <br>
[2.4](#24) <br>

</details><br>

# 2.1

**Question**. Consider the employee database of Figure 2.17. What are the appropriate primary keys?

<p align = "center">
    <img width="800" alt="Figure 2.17." src="assets/figure-2-17.png">
</p><br>

<details><summary><strong>Answer</strong>. click to expand</summary>

> dawdwa

</details><br>

# 2.2

**Question**. Consider the foreign-key constraint from the <em>dept_name</em> attribute of <em>instructor</em> to the <em>department</em> relation. Give examples of inserts and deletes to these relations that can cause a violation of the foreign-key constraint.

<p align = "center">
    <img width="800" alt="Figure 2.17." src="assets/figure-2-17.png">
</p><br>

<details><summary><strong>Answer</strong>. click to expand</summary>

> Inserting the _instructor_ tuple $t$ such that $t.{\textrm{dept}\_\textrm{name}} = \textrm{"Medical"}$
> Deleting the _department_ tuple $(\textrm{Elec. Eng.}, \textrm{Taylor}, 85000)$

</details><br>

# 2.3

**Question**. Consider the <em>time_slot</em> relation. Given that a particular <em>time_slot</em> can meet more than once in a week, explain why <em>day</em> and <em>start_time</em> are part of the primary key of this relation, while <em>end_time</em> is not.

<p align = "center">
    <img width="800" alt="Figure 2.17." src="assets/figure-2-17.png">
</p><br>

<details><summary><strong>Answer</strong>. click to expand</summary>

> Inserting the _instructor_ tuple $t$ such that $t.{\textrm{dept}\_\textrm{name}} = \textrm{"Medical"}$
> Deleting the _department_ tuple $(\textrm{Elec. Eng.}, \textrm{Taylor}, 85000)$

</details><br>

# 2.5

**Question**. What is the result of first performing the Cartesian product of <em>student</em> and <em>advisor</em>, and then performing a selection operation on the result with the predicate <em>s_id</em> = ID? (Using the symbolic notation of relational algebra, this query can be written as $\sigma_{\textrm{s}\_\textrm{id}=\textrm{ID}}(\textrm{student} \times \textrm{advisor})$.)

<details><summary><strong>Answer</strong>. click to expand</summary>

> All possible pairs generated by combining one _student_ tuple and one _advisor_ tuple will be produced by Cartesian product. By performing the selection operation, only tuples that <em>s_id</em> attribute in the portion of _advisor_ tuple equals to ID  attribute in the portion of _student_ tuple. Therefore, a student who has at least one advisor will appear a corresponding number of times in the result.

</details><br>

# 2.6

**Question**. Consider the employee database of Figure 2.17. Give an expression in the relational algebra to express each of the following queries:

<ol style="list-style-type: lower-alpha;">
    <li>Find the name of each employee who lives in city "Miami".</li>
    <li>Find the name of each employee whose salary is greater than $100000.</li>
    <li>Find the name of each employee who lives in "Miami" and whose salary is greater than $100000.</li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

> **a.** $\Pi_{\textrm{person} \_ \textrm{name}} (\sigma_{\textrm{city} = \textrm{"Miami"}} (\textrm{employee}))$ <br>
> **b.** $\Pi_{\textrm{person} \_ \textrm{name}} (\sigma_{\textrm{salary} > \$ 100000} (\textrm{works}))$ <br>
> **c.** $\Pi_{\textrm{person} \_ \textrm{name}} (\textrm{employee} \bowtie_{\textrm{city} = \textrm{"Miami"} \wedge \textrm{salary} > \$ 100000} \textrm{works})$ <br>

</details><br>

# 2.7

**Question**. Consider the bank database of Figure 2.18. Give an expression in the relational algebra for each of the following queries:

<ol style="list-style-type: lower-alpha;">
    <li>Find the name of each branch located in "Chicago".</li>
    <li>Find the ID of each borrower who has a loan in branch "Downtown".</li>
</ol>

<p align = "center">
    <img width="800" alt="Figure 2.18." src="assets/figure-2-18.png">
</p><br>

<details><summary><strong>Answer</strong>. click to expand</summary>

> **a.** $\Pi_{\textrm{branch} \_ \textrm{name}} (\sigma_{\textrm{branch} \_ \textrm{city} = \textrm{"Chicago"}} (\textrm{branch}))$ <br>
> **b.** $\Pi_{\textrm{ID}} (\sigma_{\textrm{branch} \_ \textrm{name} = \textrm{"Downtown"}} (\textrm{borrower} \bowtie_{\textrm{borrower}.\textrm{loan} \_ \textrm{number} = \textrm{loan}.\textrm{loan} \_ \textrm{number}} \textrm{\textrm{loan}}))$ <br>

</details><br>

# 2.8

**Question**. Consider the employee database of Figure 2.17. Give an expression in the relational algebra to express each of the following queries:

<ol style="list-style-type: lower-alpha;">
    <li>Find the ID and name of each employee who does not work for "BigBank"</li>
    <li>Find the ID and name of each employee who earns at least as much as every employee in the database.</li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

I guess finding ID is an errata;

> **a.** $\Pi_{\textrm{person} \_ \textrm{name}} (\textrm{employee}) - \Pi_{\textrm{person} \_ \textrm{name}} (\sigma_{\textrm{company} \_ \textrm{name} = \textrm{"BigBank"}} (\textrm{works}))$

> **b.** $\Pi_{i.\textrm{person} \_ \textrm{name}} (\rho_{i} (\textrm{works}) \bowtie_{i.\textrm{salary} \geq j.\textrm{salary} \wedge i.\textrm{person} \_ \textrm{name} \neq j.\textrm{person} \_ \textrm{name}} \rho_{j} (\textrm{works})))$ <br>

</details><br>

# 2.9

**Question**. The **division operator** of relational algebra, "$\div$" is defined as follows. Let $r(R)$ and $s(S)$ be relations, and let $S \subseteq R$; that is, every attribute of schema $S$ is also in schema $R$. Given a tuple $t$, let $t[S]$ denote the projection of tuple $t$ on the attributes in $S$. Then $r \div s$ is a relation on schema $R - S$ (that is, on the schema containing all attributes of schema $R$ that are not in schema $S$).  A tuple $t$ is in $r \div s$ if and only if both of two conditions hold: 

<ul>
    <li>$t$ is in $\Pi_{R-S}(r)$</li>
    <li>For every tuple $t_s$ in $s$, there is a tuple $t_r$ in $r$ satisfying both of the following:
        <ol style="list-style-type: lower-alpha;">
            <li>$t_r[S] = t_s[S]$</li>
            <li>$t_r[R - S] = t$</li>
        </ol>
    </li>
</ul>

<ol style="list-style-type: lower-alpha;">
    <li>Write a relational algebra expression using the division operator to find the IDs of all students who have taken all Comp. Sci. courses. (Hint: project <em>takes</em> to just ID and <em>course_id</em>, and generate the set of all Comp. Sci. <em>course_id</em>s using a select expression, before doing the division.)</li>
    <li>Show how to write the above query in relational algebra, without using division. (By doing so, you would have shown how to define the division operation using the other relational algebra operations.) </li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

I guess finding ID is an errata;

> **a.** $\Pi_{\textrm{person} \_ \textrm{name}} (\textrm{employee}) - \Pi_{\textrm{person} \_ \textrm{name}} (\sigma_{\textrm{company} \_ \textrm{name} = \textrm{"BigBank"}} (\textrm{works}))$

> **b.** $\Pi_{i.\textrm{person} \_ \textrm{name}} (\rho_{i} (\textrm{works}) \bowtie_{i.\textrm{salary} \geq j.\textrm{salary} \wedge i.\textrm{person} \_ \textrm{name} \neq j.\textrm{person} \_ \textrm{name}} \rho_{j} (\textrm{works})))$ <br>


</details><br>

# 2.10

**Question**. Describe the differences in meaning between the terms <em>relation</em> and <em>relation schema</em>.

<details><summary><strong>Answer</strong>. click to expand</summary>

> 

</details><br>

# 2.11

**Question**. Consider the <em>advisor</em> relation shown in the schema diagram in Figure 2.9, with <em>s_id</em> as the primary key of <em>advisor</em>. Suppose a student can have more than one <em>advisor</em>. Then, would <em>s_id</em> still be a primary key of the <em>advisor</em> relation? If not, what should the primary key of <em>advisor</em> be?

<details><summary><strong>Answer</strong>. click to expand</summary>

>

</details><br>

# 2.14

**Question**. Consider the employee database of Figure 2.17. Give an expression in the relational algebra to express each of the following queries:

<ol style="list-style-type: lower-alpha;">
    <li>Find the ID and name of each employee who works for "BigBank".</li>
    <li>Find the ID, name, and city of residence of each employee who works for "BigBank".</li>
    <li>Find the ID, name, street address, and city of residence of each employee who works for "BigBank" and earns more than $10000.</li>
    <li>Find the ID and name of each employee in this database who lives in the same city as the company for which she or he works.</li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

I guess finding ID is an errata;

> **a.** $\Pi_{\textrm{employee}.\textrm{person}\_\textrm{name}} (\sigma_{\textrm{company}\_\textrm{name} = ``\textrm{BigBank}"} (\textrm{employee} \bowtie_{\textrm{employee}.\textrm{person}\_\textrm{name} = \textrm{works}.\textrm{person}\_\textrm{name}} \textrm{works}))$ <br>
> **b.** $\Pi_{\textrm{employee}.\textrm{person}\_\textrm{name}, \textrm{city}} (\sigma_{\textrm{company}\_\textrm{name} = ``\textrm{BigBank}"} (\textrm{employee} \bowtie_{\textrm{employee}.\textrm{person}\_\textrm{name} = \textrm{works}.\textrm{person}\_\textrm{name}} \textrm{works}))$ <br>
> **c.** $\Pi_{\textrm{employee}.\textrm{person}\_\textrm{name}, \textrm{street}, \textrm{city}} (\sigma_{\textrm{company}\_\textrm{name} = ``\textrm{BigBank}" \wedge \textrm{salary} > \$10000} (\textrm{employee} \bowtie_{\textrm{employee}.\textrm{person}\_\textrm{name} = \textrm{works}.\textrm{person}\_\textrm{name}} \textrm{works}))$  <br>
> **d.** $\Pi_{\textrm{employee}.\textrm{person}\_\textrm{name}} (\sigma_{\textrm{employee}.\textrm{city} = \textrm{company}.\textrm{city}} (\textrm{employee} \bowtie_{\textrm{employee}.\textrm{person}\_\textrm{name} = \textrm{works}.\textrm{person}\_\textrm{name}} \textrm{works} \bowtie_{\textrm{works}.\textrm{company}\_\textrm{name} = \textrm{company}.\textrm{company}\_\textrm{name}} \textrm{company} ))$ <br>

</details><br>

# 2.15

**Question**. Consider the bank database of Figure 2.18. Give an expression in the relational algebra for each of the following queries:

<ol style="list-style-type: lower-alpha;">
    <li>Find each loan number with a loan amount greater than $10000.</li>
    <li>Find the ID of each depositor who has an account with a balance greater than $6000.</li>
    <li>Find the ID of each depositor who has an account with a balance greater than $6000 at the "Uptown" branch.</li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

> **a.** $\Pi_{\textrm{loan}\_\textrm{number}} (\sigma_{\textrm{amount} > \$10000} (\textrm{loan}))$ <br>
> **b.** $\Pi_{\textrm{ID}} (\sigma_{\textrm{balance} > \$6000} ( \textrm{depositor} \bowtie_{\textrm{depositor}.\textrm{account}\_\textrm{name} = \textrm{account}.\textrm{account}\_\textrm{name}} \textrm{account}))$ <br>
> **c.** $\Pi_{\textrm{ID}} (\sigma_{\textrm{balance} > \$6000 \wedge \textrm{branch}\_\textrm{name} = ``\textrm{Uptown}"} ( \textrm{depositor} \bowtie_{\textrm{depositor}.\textrm{account}\_\textrm{name} = \textrm{account}.\textrm{account}\_\textrm{name}} \textrm{account}))$ <br>

</details><br>

# 2.18

**Question**. Write the following queries in relational algebra, using the university schema.

<ol style="list-style-type: lower-alpha;">
    <li>Find the ID and name of each instructor in the Physics department.</li>
    <li>Find the ID and name of each instructor in a department located in the building "Watson".</li>
    <li>Find the ID and name of each student who has taken at least one course in the "Comp. Sci." department.</li>
    <li>Find the ID and name of each student who has taken at least one course section in the year 2018.</li>
    <li>Find the ID and name of each student who has not taken any course section in the year 2018.</li>
</ol>

<details><summary><strong>Answer</strong>. click to expand</summary>

> **a.** $\Pi_{\textrm{ID}, \textrm{name}} (\sigma_{\textrm{dept}\_\textrm{name} = ``\textrm{Physics}"} (\textrm{instructor}))$ <br>
> **b.** $\Pi_{\textrm{ID}, \textrm{name}} (\sigma_{\textrm{building} = ``\textrm{Watson}"} (\textrm{instructor} \bowtie_{\textrm{instructor}.\textrm{dept}\_\textrm{name} = \textrm{department}.\textrm{dept}\_\textrm{name}} \textrm{department} ))$ <br>
> **c.** $\Pi_{\textrm{ID}, \textrm{name}} (\sigma_{\textrm{dept}\_\textrm{name} = ``\textrm{Comp. Sci.}"} (\rho_{S} (\textrm{student} \bowtie_{\textrm{student}.\textrm{ID} = \textrm{takes}.\textrm{ID}} \textrm{takes} \textrm{takes}) \bowtie_{S.\textrm{course}\_\textrm{id} = \textrm{course}.\textrm{course}\_\textrm{id}} \textrm{course}))$ <br>
> **d.** $\Pi_{\textrm{student}.\textrm{ID}, \textrm{name}} (\sigma_{\textrm{year} = 2018} \textrm{student} \bowtie_{\textrm{student}.\textrm{ID} = \textrm{takes}.\textrm{ID}} \textrm{takes})$ <br>
> **e.** $\Pi_{\textrm{ID}, \textrm{name}} (\textrm{student}) - \Pi_{\textrm{student}.\textrm{ID}, \textrm{name}} (\sigma_{\textrm{year} = 2018} \textrm{student} \bowtie_{\textrm{student}.\textrm{ID} = \textrm{takes}.\textrm{ID}} \textrm{takes} \textrm{takes})$ <br>

</details><br>